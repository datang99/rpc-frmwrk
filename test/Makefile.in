include Makefile.init.pub

all: debug

debug:
	@if [ ! -e $(OUTPUT_DIR)/libcombase.so ]; then cd $(OUTPUT_DIR);ln -s ../../$(DBG_DIR)/libcombase.so;cd -;fi
	@if [ ! -e $(OUTPUT_DIR)/libipc.so ]; then cd $(OUTPUT_DIR);ln -s ../../$(DBG_DIR)/libipc.so;cd -;fi
	@if [ ! -e $(OUTPUT_DIR)/librpc.so ]; then cd $(OUTPUT_DIR);ln -s ../../$(DBG_DIR)/librpc.so;cd -;fi
	@if [ ! -e $(OUTPUT_DIR)/libsslpt.so ]; then cd $(OUTPUT_DIR);ln -s ../../$(DBG_DIR)/libsslpt.so;cd -;fi
	@if [ ! -e $(OUTPUT_DIR)/libwspt.so ]; then cd $(OUTPUT_DIR);ln -s ../../$(DBG_DIR)/libwspt.so;cd -;fi
	make -j -l 5 -C helloworld
	make -j -l 5 -C iftest
	make -j -l 5 -C asynctst
	make -j -l 5 -C smoketest
	make -j -l 5 -C actcancel
	make -j -l 5 -C evtest
	make -j -l 5 -C inproc
	make -j -l 5 -C katest
	make -j -l 5 -C prtest
	make -j -l 5 -C sftest
	make -j -l 5 -C stmtest
	make -j -l 5 -C router
	make -j -l 5 -C btinrt

release:
	@if [ ! -e $(OUTPUT_DIR)/libcombase.so ]; then cd $(OUTPUT_DIR);ln -s ../../$(RLS_DIR)/libcombase.so;cd -;fi
	@if [ ! -e $(OUTPUT_DIR)/libipc.so ]; then cd $(OUTPUT_DIR);ln -s ../../$(RLS_DIR)/libipc.so;cd -;fi
	@if [ ! -e $(OUTPUT_DIR)/librpc.so ]; then cd $(OUTPUT_DIR);ln -s ../../$(RLS_DIR)/librpc.so;cd -;fi
	@if [ ! -e $(OUTPUT_DIR)/libsslpt.so ]; then cd $(OUTPUT_DIR);ln -s ../../$(RLS_DIR)/libsslpt.so;cd -;fi
	@if [ ! -e $(OUTPUT_DIR)/libwspt.so ]; then cd $(OUTPUT_DIR);ln -s ../../$(RLS_DIR)/libwspt.so;cd -;fi
	make -j -l 5 -C helloworld release
	make -j -l 5 -C iftest release
	make -j -l 5 -C asynctst release
	make -j -l 5 -C smoketest release
	make -j -l 5 -C actcancel release
	make -j -l 5 -C evtest release
	make -j -l 5 -C inproc release
	make -j -l 5 -C katest release
	make -j -l 5 -C prtest release
	make -j -l 5 -C sftest release
	make -j -l 5 -C stmtest release
	make -j -l 5 -C router release
	make -j -l 5 -C btinrt release

clean:
	make -C helloworld clean
	make -C iftest clean
	make -C asynctst clean
	make -C smoketest clean
	make -C actcancel clean
	make -C evtest clean
	make -C inproc clean
	make -C katest clean
	make -C prtest clean
	make -C sftest clean
	make -C stmtest clean
	make -C router clean
	make -C btinrt clean

release_clean:
	make -C helloworld release_clean
	make -C iftest release_clean
	make -C asynctst release_clean
	make -C smoketest release_clean
	make -C actcancel release_clean
	make -C evtest release_clean
	make -C inproc release_clean
	make -C katest release_clean
	make -C prtest release_clean
	make -C sftest release_clean
	make -C stmtest release_clean
	make -C router release_clean
	make -C btinrt release_clean

debug_clean:
	make -C helloworld debug_clean
	make -C iftest debug_clean
	make -C asynctst debug_clean
	make -C smoketest debug_clean
	make -C actcancel debug_clean
	make -C evtest debug_clean
	make -C inproc debug_clean
	make -C katest debug_clean
	make -C prtest debug_clean
	make -C sftest debug_clean
	make -C stmtest debug_clean
	make -C router debug_clean
	make -C btinrt debug_clean

.PHONY: release clean debug_clean debug
