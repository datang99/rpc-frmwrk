include ./Makefile.init.pub

ifeq ($(MODE),Release)
	OUTPUT_DIR := ./release
endif

TARGETS := $(OUTPUT_DIR)/libcombase.so $(OUTPUT_DIR)/libipc.so $(OUTPUT_DIR)/librpc.so test

all: $(TARGETS)
debug: $(TARGETS)
release: $(TARGETS)
clean: $(TARGETS)

mygoal:=$(MAKECMDGOALS)
$(OUTPUT_DIR)/libcombase.so :
	-make -C ./combase $(mygoal)
	
$(OUTPUT_DIR)/libipc.so :
	-make -C ./ipc $(mygoal)

$(OUTPUT_DIR)/librpc.so :
	-make -C ./rpc $(mygoal)

test:
	-make -C test $(mygoal)

.PHONY: $(TARGETS) test
